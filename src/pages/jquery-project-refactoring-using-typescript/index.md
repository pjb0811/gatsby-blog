---
title: TypeScript를 활용한 JQuery 프로젝트 리팩토링
date: '2019-01-03'
mainImage: './refactoring-ts.png'
tags: ['javascript', 'typescript']
---

> 처음 TypeScript를 접하고 사용해보면서 개인적으로 꼭 배워야 하는 언어(언어라고 표헌하긴 애매할 수 도 있을 것 같은데 딱히 다른 단어가 떠오르지 않는다)라서 생각해서 개인적인 프로젝트 진행 시 TypeScript를 사용하려 노력했다. 아직 부족한 부분이 많고 앞으로도 계속 공부할 생각이며, 우선 지금까지 TypeScript를 활용한 프로젝트 중 하나에 대한 내용을 정리하려고 한다. 다른 사람에게 설명하기 보다는 스스로의 학습 내용을 정리하는 글이기 때문에 편한 말투로 작성했다.

현재 글을 최초 작성하는 2019년 1월 3일 기준으로 대략 3개월 전인 2018년 10월 16일 부터 현재 일하고 있는 회사의 JQuery 기반의 프로젝트를 TypeScript로 리펙토링하는 작업을 진행했다. 이제 막 그 작업을 완료했다고 생각해여 리펙토링 과정에서 느끼고 배웠던 내용들을 정리해보려 한다. 사실 회사에서 주어진 업무가 아니라 스스로 TypeScript를 공부하기 위한 방법으로 프로젝트를 진행했기 때문에 개인적인 프로젝트라고 보는게 맞을지도 모르겠다.

그래서 현재 회사에서 운영 중인 개발 환경 아직 TypeScript로 구현되어 있지 않다. 개인적인 학습 목표를 위해 진행한 내용이기도 하고 팀 내 다른 개발자 분들이 구현해 놓은 많은 양의 코드를 리펙토링 했기 때문에 이 전 코드와 기능 상 차이가 생길 수도 있고, 그럴 경우 운영 환경 배포 시 크리티컬한 이슈가 생길 수도 있다고 생각했다. 실제로 리펙토링 과정을 거치면서 다른 개발자분들이 미처 수정하지 못한 많은 오류들을 발견했고 오류들을 수정하면서 타입을 지정하는 걸 넘어선 코드의 변화가 일어나게 되었다.

다만 로컬환경에 확인한 바로는 잘 동작했기 때문에 실제 운영 환경에 적용되더라도 이상이 없을 것이라 개인적으로 생각하는 바이며, 이 후 운영 환경에 적용되게 된다며 관련 내용을 업데이트 하도록 하자.

## 기본 환경 설정

우선 처음 작업을 진행한 날짜의 기준은 최초 프로젝트의 브랜치를 생성한 커밋 일자 기준이며, 그 전부터 회사 프로젝트를 리팩토링 해보고 싶었는데 다른 회사 업무나 개인적인 프로젝트 진행, 블로그 글 정리 등 때문에 늦어진 감이 있다. 그리고 무엇보다 TypeScript를 사용하기 위한 기본적인 환경 설정이 생각보다 오래 걸렸다. 대충 생각나는 대로만 봐도 일주일 정도 걸렸던 것 같다.

그래도 기본 환경 설정이 완료되고 나니 리팩토링 과정에 속도를 낼 수 있었다. 기본 환경 설징 더 늦었다면 지금도 리팩토링 작업을 진행하고 있을지도 모른다. 그러한 관점에서 꼭 정리해야 할 내용이라 생각하며 글을 시작하는 주제로 먼저 기본 환경 설정에 대한 내용을 정리했다.

### package 설치

TypeScript를 사용하기 위해 `typescript`를 설치하고 가이드에서 설명하는 내용대로 webpack 설정을 진행하면 쉽게 사용할 수 있을 것이라 생각했는데, 빌드 실행부터 생각치 못한 많은 에러를 접하게 되었다. 그래서 환경 설정에 대한 방법들을 웹에서 검색하며 확인했고 (이 과정이 꽤 오래 걸렸다), 그 결과 기존 프로젝트에 설정된 webpack 관련 라이브러러와 설치한 TypeScript 버전간의 호환성 문제가 있었다.

그래서 기존 프로젝트 내 라이브러리의 버전 업그레이드 및 필요한 라이브러리의 설치를 진행하였고, 리펙토링 중간중간 필요한 타입 설정에 대한 라이브러리를 추가하다 보니 작업 완료 시에는 생각보다 꽤 많은 라이브러리에 대한 설치 및 버전 업그레이드가 생기게 되었다.

- `package.json`

```json
{
  // ...
  "dependencies": {
    // ...
    "webpack": "4.22.0"
    // ...
  },
  "devDependencies": {
    // ...
    "@types/crypto-js": "^3.1.43",
    "@types/jquery": "^3.3.22",
    "@types/jquery.cookie": "^1.4.31",
    "@types/jqueryui": "^1.12.6",
    "@types/swiper": "^4.4.1",
    "ansi-styles": "^3.2.1",
    "awesome-typescript-loader": "^5.2.1",
    "chalk": "^2.4.1",
    "loader-utils": "^1.1.0",
    "resolve-from": "^4.0.0",
    "typescript": "^3.1.3",
    "webpack-bundle-analyzer": "2.10.0",
    "webpack-cli": "^3.1.2",
    "webpack-dashboard": "^2.0.0"
    // ...
  }
}
```

우선 기존 프로젝트의 webpack 버전이 `2.3.3` 이었기 때문에 webpack을 작업 당시 기준 최신 버전으로 업그레이드 해주었다. 기존에 설치된 라이브러리의 버전을 최대한 유지한 상태에서 환경 설정을 해주고 싶었지만 도저희 기존 webpack 버전에서 typescript를 설정할 수 있는 방법을 찾지 못했다. 그렇다고 typescript 버전을 webpack 버전이 맞게 다운그레이드
